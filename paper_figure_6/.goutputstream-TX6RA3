#!/bin/bash
#SBATCH --mail-user=giffordale95@zedat.fu-berlin.de
#SBATCH --job-name=paper_figure_6-01_test_encoding
#SBATCH --mail-type=end
#SBATCH --mem=2500
#SBATCH --time=00:30:00
#SBATCH --qos=standard

# Create the parameters combinations
declare -a subject_all
declare -a nsdsynthetic_image_class_all
declare -a model_all
index=0
for s in `seq 1 8` ; do
	for c in `seq 0 7` ; do
		for m in 'alexnet' 'resnet50' 'moco' 'vit_b_32' ; do
			subject_all[$index]=$s
			nsdsynthetic_image_class_all[$index]=$c
			model_all[$index]=$m
			((index=index+1))
		done
	done
done

# Extract the parameters
echo SLURM_ARRAY_JOB_ID: $SLURM_ARRAY_TASK_ID
subject=${subject_all[$SLURM_ARRAY_TASK_ID]}
nsdsynthetic_image_class=${nsdsynthetic_image_class_all[$SLURM_ARRAY_TASK_ID]}
model=${model_all[$SLURM_ARRAY_TASK_ID]}
echo subject: $subject
echo nsdsynthetic_image_class: $nsdsynthetic_image_class
echo model: $model

# Wait a bit so it doesn't crash
sleep 8

# Activate the Anaconda environment
source /home/giffordale95/anaconda3/etc/profile.d/conda.sh
conda activate general

# Change to the .py script directory
cd /home/giffordale95/projects/nsd_synthetic/code_revisions/paper_figure_6

# Run the job
python 01_test_encoding.py --subject $subject --nsdsynthetic_image_class $nsdsynthetic_image_class --model $model

